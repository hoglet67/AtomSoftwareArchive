10 *NOMON
20 CLEAR 4
30 *LOAD MNU/SCREEN2
40 FOR A=1TO60;WAIT;N.
50 CLEAR 0
60 *LOAD MNU/MENUDAT
70 *LOAD MNU/SORTDAT
80 *LOAD MNU/MENUMC
90 REM ATOMMC SELECTION MENU
100 
110 REM GENERAL SETTINGS
120 P=1;L=13
160 
170 REM PAGE HEADER
180 P.$12;?#E1=0
190 ?#80=17;GOS.y
200 ?#801B=P/10+176;?#801C=P%10+176
210 ?#801E=M/10+176;?#801F=M%10+176
220 
230 REM BUILD MENUPAGE
240 P.$30''
250 !#80=Z+(P-1)*L*2
260 LINK #3300
270 GOS.i
280 
290 REM SHIFT-KEY
300 IF ?#B001&128>0;G.370
310  IF Y>0;G.340
320  IF P=1;G.300
330  P=P-1;GOS.i;Y=12;G.200
340  GOS.i;Y=Y-1;GOS.i;G.300
350 
360 REM CTRL-KEY
370 IF?#B001&64>0;G.440
380  IF Y<>12;G.410
390  IF P=M;G.300
400  P=P+1;GOS.i;Y=0;G.200
410  IF ?(#8060+Y*32)=32;G.440
415  GOS.i;Y=Y+1;GOS.i;G.300
420 
430 REM REPT-KEY
440 IF?#B002&64>0;G.480
450 P=(P%M)+1;GOS.i;Y=0;G.200
460 
470 REM CALL INKEY
480 LINK #3303
490 IF ?#80=0;G.300
500 IF ?#80<17 OR ?#80>20;G.540
520 GOS.y;G.200
530 
540 IF ?#80<21 OR ?#80>23;G.580
560 GOS.x;G.200
570 REM BOOTLOAD PROGRAM
580 IF ?#80>32 AND ?#80<46;Y=?#80-33
585 IF ?(#8040+Y*32)=32;G.300
590 I=(P-1)*13+Y
600 J=Z!(I*2)
610 K=(!J)&#3FF
620 P=#100
630 $P="RUN MNU/"
640 P=P+LEN(P)
650 IF K>99;?P=48+(K/100)%10;P=P+1
660 F=!(#8204+(?#80-21)*2)&#FFFF
670 IF K>9;?P=48+(K/10)%10;P=P+1
680 ?P=48+K%10
690 P?1=13
700 P?2=13
710 LINK #FFF7
720 END
730iA=#8040+Y*32
740 F.I=0TO31S.4;I!A=I!A:#80808080;N.
750 R.
760xP.$30
770 IF ?#80=21;P." FILTER/PUBLISHER     PAGE   /  "'
780 IF ?#80=22;P." FILTER/GENRE         PAGE   /  "'
790 IF ?#80=23;P." FILTER/COLLECTION    PAGE   /  "'
800 Z=!(#8204+(?#80-21)*2)&#FFFF;?#8B=255
810 G.900
820yP.$30
830 IF ?#80=17;P." ATOMMC BY TITLE      PAGE   /  "'
840 IF ?#80=18;P." ATOMMC BY PUBLISHER  PAGE   /  "'
850 IF ?#80=19;P." ATOMMC BY GENRE      PAGE   /  "'
860 IF ?#80=20;P." ATOMMC BY COLLECTION PAGE   /  "'
870 Z=!(#3600+(?#80-17)*2)&#FFFF;?#8B=0
900 Y=-2;GOS.i;Y=0;P=1
910 M=!Z&#FFFF;M=(M+L-1)/L;Z=Z+2;RET.

