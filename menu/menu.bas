
10 *NOMON
20 CLEAR 4
30 *LOAD SCREEN2.ATM
40 FOR A=0 TO 1000;N.
50 CLEAR 0
60 *LOAD MNU/MENUDAT
70 *LOAD MNU/SORTDAT
80 *LOAD MENUMC
90 REM ATOMMC SELECTION MENU
100 
110 REM GENERAL SETTINGS
120 P=1;L=13;Y=0
130 M=(!#3602&#FFFF-!#3600&#FFFF)/2-1
140 M=(M+L-1)/L
150 Z=#3608
160 
170 REM PAGE HEADER
180 P.$12;?#E1=0
190 P."€page€€of€€press€Ÿ€for€help€"'
200 ?#8006=P/10+176;?#8007=P%10+176
210 ?#800C=M/10+176;?#800D=M%10+176
220 
230 REM BUILD MENUPAGE
240 P.$30''
250 !#80=Z+(P-1)*L*2
260 LINK #3300
270 GOS.i
280 
290 REM SHIFT-KEY
300 IF ?#B001&128>0;G.370
310  IF Y>0;G.340
320  IF P=1;G.300
330  P=P-1;GOS.i;Y=12;G.200
340  GOS.i;Y=Y-1;GOS.i;G.300
350 
360 REM CTRL-KEY
370 IF?#B001&64>0;G.440
380  IF Y<>12;G.410
390  IF P=M;G.300
400  P=P+1;GOS.i;Y=0;G.200
410  GOS.i;Y=Y+1;GOS.i;G.300
420 
430 REM REPT-KEY
440 IF?#B002&64>0;G.480
450 P=(P%M)+1;GOS.i;Y=0;G.200
460 
470 REM CALL INKEY
480 LINK #3303
490 IF ?#80=0;G.300
500 IF ?#80<17 OR ?#80>20;G.540
510 Z=!(#3600+(?#80-17)*2)&#FFFF
520 GOS.i;P=1;Y=0;G.200
530 
540 IF ?#80<21 OR ?#80>23;G.580
550 F=!(#8204+(?#80-21)*2)&#FFFF
560 GOS.z;P=1;Y=0;G.200
570 REM BOOTLOAD PROGRAM
580 IF ?#80>32 AND ?#80<46;Y=?#80-33
590 I=(P-1)*13+Y
600 J=Z!(I*2)
610 K=(!J)&#3FF
620 P=#100
630 $P="RUN MNU/"
640 P=P+LEN(P)
650 IF K>99;?P=48+(K/100)%10;P=P+1
660 F=!(#8204+(?#80-21)*2)&#FFFF
670 IF K>9;?P=48+(K/10)%10;P=P+1
680 ?P=48+K%10
690 P?1=13
700 P?2=13
710 LINK #FFF7
720 END
730iA=#8040+Y*32
740 F.I=0TO31S.4;I!A=I!A:#80808080;N.
750 R.
760zP.$12
770 IF ?#80=21;P."FILTER BY PUBLISHER"'
780 IF ?#80=22;P."FILTER BY GENRE"'
790 IF ?#80=23;P."FILTER BY COLLECTION"'
800 Y=-2;GOS.i
805 P.'
810 G=F
815 I=65
820 H=!G&#FFFF
830 IF H=#FFFF;G.870
840 P.$I"."$H'
850 G=G+4
855 I=I+1
860 G.820
870 LINK#FFE3
880 RET.
