
0REM /// MASTERMIND /// V3
20 M=#2800;N=M+4;C=N+4;B=C+1;L=B+1;U=L+10
23 G=U+25;R=G+41;O=R+41;W=O+1
25 DIM ZZ10,EE2,SS4
60 EE0=#3347;EE1=#3385;EE2=#3300
1000 DO SS1=SS1+1;SS2=SS2+1;T=#8020;?#E1=0
1005 Y=1; Z=1
1007 CLEAR0; MOVE4,4;DRAW4,47;MOVE35,4;DRAW35,47
1008 MOVE0,44;DRAW63,44;MOVE0,4;DRAW63,4
1009 MOVE34,4;DRAW34,47;MOVE63,4;DRAW63,47
1010 GOSUB c
1015 A=!M
1020 GOSUB c; Q=!M
1030 I=0;P.$30$9$9$9"  YOU:    B C "$9"  ATOM:   B C"'
1040 DO I=I+4;T=T+32
1050 T?1=I/4%10+#30;IFI/4>9;T?0=#31
1100 IF Y GOSUB a;SS4=SS4+1
1200 IF Z GOSUB b;SS3=SS3+1
1220 IFI=48A.Y GOS.l;P."TOO MANY ATTEMPTS.";Y=0;Z=0;SS1=SS1-1
1350 UNTIL Y=0 AND Z=0
1360 P." SCORE?";LINK#FFE3
1400P.$12"             scores"''
1410P."         GAMES: TURNS: AVERAGE:"''
1420P."ATOM.     ";I=SS1;J=SS3;GOS.s
1430P."OPPONENT. ";I=SS2;J=SS4;GOS.s
1432 IF SS2=0 P."   ATOM AHEAD!"'';G.p
1435 IF SS1*SS4=SS2*SS3 P."   SO FAR - EQUAL!" '';G.p
1440 IF SS1*SS4<SS2*SS3P."   YOU ARE WINNING!"'';G.p
1450 P."   ATOM IN THE LEAD!"''
1500pP."PRESS RETURN TO PLAY AGAIN";LINK#FFE3;U.0
1600s@=5;P.I"  "J
1700 IFI=0P." INFINITE"'';R.
1705P.J/I".";@=1
1710 F.K=0TO2;J=J%I*10;P.J/I;N.
1720P.'';R.
2010fGOS.c; !W=!M; ?O=I; E=0
2020 GOS.l;P."THINKING"
2160 DO LINK EE0
2165 IF !M=!W UNTIL 1; R.
2220 E=E+1; ZZE=!M; P."."
2230 UNTIL E=10; R.
3010mIFE=0 GOS.l;P."YOU CHEATED";Z=0;R.
3020 F=0
3030 F.D=1 TO E
3040 F.K=0 TO 24; U?K=0; N.
3050 F.J=1 TO E; !M=ZZD; !N=ZZJ
3060 LINK EE2; U?(?B*5+?C)=U?(?B*5+?C)+1
3070 N.;H=0
3080 F.K=0 TO 24
3090 IF U?K<>0 H=H+1
3100 N.; IF H>F F=H; Q=ZZD
3110 N.D
3120 GOS.l;R.
4005cJ=ABSRND
4010uFOR K=0 TO 3
4020 M?K=J%10
4030 J=J/10
4040 NEXT
4050 RETURN
5010gFOR K=0 TO 3
5020 T?(19+K*2)=H&15+#B0
5030 H=H/256; NEXT
5040 R.
5100rGOS.l;P."MY NUMBER WAS:         "
5110 H=A;J=T;T=#81DC;GOS.g
5120 T=J;SS2=SS2-1;SS4=SS4-1;R.
6020aK=0;DO
6030 IFK<4;T?(K*2+4)=#43
6040 LINK EE1;J=?C
6045 IFJ=CH"R"U.1;Y=0;T?(K*2+4)=#12;GOS.r;R.
6050 IFJ>47A.J<58A.K<4M?K=?C-#30;T?(K*2+4)=?C+#80;K=K+1
6055 IFK>0A.J=#7FK=K-1;IFK<3;T?(K*2+6)=32
6060 U.K=4A.J=13
6065 !N=A;LINKEE2
6070 T?13=?B+#30;T?15=?C+#30
6075 IF!C<>#400 R.
6080 Y=0;GOS.l; IFZ P."...AND YOU WIN";R.
6085 P." ABOUT TIME TOO!";R.
7080bH=Q; GOSUB g
7100 K=0;DO
7110 IFK<2;T?(K*2+28)=#43
7115 LINKEE1; J=?C
7120 IFJ>47A.J<58A.K<2;T?(28+K*2)=J;K=K+1
7130 IFK>0A.J=#7FK=K-1;IFK<1;T?(K*2+30)=32
7135 UNTILK=2A.J=13
7140 V=T?28*256+T?30-12336
7145 R!(I-4)=V
7150 G!(I-4)=Q
7200 GOS.l
7225 IF V<>#400GOS.f; GOS.m; IF Z R.
7230 IF Y P."...SO I WIN!";Z=0;R.
7240 IF Z P."GOT IT!";Z=0;R.
8000l!#DE=#81E0;F.K=0TO31;K?#81E0=32;N.;R.
0 (C) ACORNSOFT 1980
