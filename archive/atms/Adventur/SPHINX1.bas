
1000 PROGRAM SPHINX ADVENTURE
1010FUNCTION LEFT(S,L)
1020IF L<1;LEFT=#24C0
1030$#24C0=$S;L?#24C0=13
1040LEFT=#24C0
1050FEND
1060FUNCTION RIGHT(S,L)
1070IF L<1;RIGHT=#2434
1080$#2434=$S;IF L<LEN(S) $#2434=$(S+L.(S)-L)
1090RIGHT=#2434
1100FEND
1110FUNCTION ADD(A,B),P,I
1120P=#25D8;$P=$A;P=P+L.A
1130F.I=0TO L.B;I?P=I?B;N.
1140P=P+L.B+1;?P=13
1150ADD=#25D8
1160FEND
1170PROC PF(Z,N),I,J
1180I=N-CC3;$U=$Z
1190F.J=0 TO L.(U)-1;IF U?J<>32;U?J=U?J-7
1200N.
1210DO I=I-1;CC2=CC2+1;U.U?I=32 OR I<=0 OR U?I=13
1220XIFI>0 AND L.(U)>N
1230$Q=$U;Q?I=13;P.$Q';$Q=$(U+I+1);ENC(Q);PF(Q,31)
1240ELSE P.$U
1250PEND
1260PROC THROW(W),P
1270GEN(W,1,L);IFX=1;PEND
1280$R=""
1290XIFW<2
1300XIFL=O?31;IF A.R.%10<6;O?31=0;CC30=0;REP(9)
1310ELSE IFL=O?31;$Q="[OL K^HYM KVKNLZ ULH[S` HZPKL";PF(Q,31);P.'
1320CASE L OF
1330<O?32> $Q="[OL VYNL JH[JOLZ [OL H_L HUK ZSPJLZ `V\ PU [^V ^P[O P[";PF(Q,31);P.';DEATH
1340<O?30> $Q="[OL H_L IV\UJLZ OHYTSLZZS` VMM [OL KYHNVU5";PF(Q,31);P.'
1350<O?33> REP(10)
1360<O?34> $Q="[OL [YVSS K\JRZ3 WPJRZ \W [OL MHSSLU H_L HUK RPSSZ `V\ ^P[O H ZPUNSL ISV^";PF(Q,31);P.'
1370<O?35> REP(11)
1380<O?36> REP(12);O?36=20+A.R.%10
1390<O?37> REP(13)
1400<O?38> REP(14)
1410CEND
1420P=0;PEND
1430ELSE
1440XIF W<3
1450CASE L OF
1460<O?31> REP(9);CC30=0;O?31=0
1470<O?32> $Q="[OL Z^VYK RPSSZ [OL VYNL I\[ [OLU TLS[Z H^H`5";PF(Q,31);P.';O?32=0;O?2=0
1480<O?30> REP(42);O?30=0;O?2=0;O?6=L
1490<O?33> REP(10)
1500<O?34> $Q="[OL [YVSS JH[JOLZ [OL Z^VYK HUK RPSSZ `V\ ^P[O H ZPUNSL Z[YVRL5";PF(Q,31);P.'
1510<O?35> REP(11)
1520<O?36> REP(12);O?36=20+A.R.%10
1530<O?37> REP(13)
1540<O?38> REP(14)
1550CEND
1560P=0;PEND
1570ELSE
1580IF W=28 AND L=16 AND CC5=1;CC5=0;$Q="[OL MSHTL KPLZ PU H JSV\K VM Z[LHT5";PF(Q,31);P.'
1590XIF W=6 AND L=O?33;$Q="[OL [LL[O ILJVTL ZRLSL[VU ^HYYPVYZ HUK KYP]L [OL NVISPUZ H^H`5";PF(Q,31);P.';O?33=0;O?6=0
1600ELSE IF L=O?41 AND W=47;REP(40);O?41=0;O?47=0
1610$R="";IFL=117AND W=9;REP(45);L=118;O?9=0;LOCAT(L)
1620IFL=O?43;IFW=49;REP(43);O?43=0;O?49=0
1630PEND
1640PROC OP(W)
1650IF W?O<>L AND W?O<>1 AND W<>28;REP(7);$Q=" OLYL5";$Q=$ADD(AA2,Q);PF(Q,31);P.';PEND
1660IF W=40 AND L=94 AND CC17=0;O?43=94;CC9=1;LOCAT(L);PEND
1670IF W=39;REP(20)
1680XIF W=8 AND O?5=1;REP(17);O?16=L
1690ELSE IFW=8;REP(18)
1700XIF W=10 AND O?7=1;REP(19);O?18=L
1710ELSE IFW=10;REP(20)
1720IFW=8 OR W=10 OR W=39;PEND
1730REP(21)
1740PEND
1750PROC KILL(W),P
1760$#25D8="";P=0
1770IF W?O<>L;REP(7);$Q=" OLYL5";$Q=$ADD(AA2,Q);PF(Q,31);P.';PEND
1780IFW<30 OR W=39 OR W=40 OR A.(W-48)<4 OR W>52;REP(6);PEND
1790WHILE P=0
1800IN."WHAT WITH? YOUR BARE HANDS      YES OR NO "$#25D8
1810IF$#25D8="NO";P=1
1820IF$#25D8="YES";P=1
1830WEND
1840XIF $#25D8="NO";IN."WHAT WITH THEN"$AA2;NITEM(AA2);IF X=1;PEND
1850$AA1="THROW";THROW(F);IF X=1;PEND
1860C=C-1;PEND
1870ELSE
1880XIF W=30;REP(16);O?30=0;O?6=L
1890ELSE P."YOUR BLOWS ARE USELESS."'
1900PEND
1910PROC GEN(W,N,K),I,P
1920XIF W=8 OR W=10 OR A.(W-37)<=7 OR W>=53
1930X=1
1940IF W?O<>N;REP(8-SGN(N-1));$Q=" OLYL";$Q=$ADD(AA2,Q);PF(Q,31);P.';PEND
1950REP(6);PEND
1960ELSE
1970$R="";IF K=1 AND W=28 AND O?27<>1 AND L=15 ;P."YOU HAVE NOTHING TO PUT IT IN,  SO IT RUNS AWAY THROUGH YOUR"'"FINGERS."';PEND
1980P=0
1990IF W=28 ANDCC22=1;O?28=1;P=1
2000XIFW=28 AND P=0;O?28=15
2010ELSE IFW=52 AND K=1 AND P=0;REP(41);PEND
2020$R="";IF W=52 AND N=1 AND K=111 AND O?42=111;O?42=0;$AA1="KYVW";$AA2="TV\ZL";$Q="[OL LSLWOHU[ ZLLZ P[ HUK Y\UZ H^H`";$AA2=$ADD(AA2,Q)
2030$R=""
2040IF C=15 AND K=1;$Q="`V\ JHU.[ JHYY` TVYL3`V\.SS OH]L [V KYVW ZVTL[OPUN MPYZ[5";PF(Q,31);P.';X=1;PEND
2050P=0
2060IFK=1 AND O?27=1 AND O?28=1 AND W=28;P."YOUR BOTTLE IS ALREADY FULL."';X=1;P=1
2070IF P=0;IFN=1 AND W=27 AND CC22=1;CC22=0;P."YOU DROP THE BOTTLE AND ALL WATER LEAKS AWAY"';C=C-1;$AA1="^PSS OH]L [V NL[ ZVTL TVYL MYVT ";$AA2="SHRL"
2080IF W=28 AND K=1 AND O?28=N AND P=0;$AA1="MPSS";$AA2="IV[[SL ^P[O [OL ^H[LY"
2090IF W?O=N;IFP=0;W?O=K;$Q="`V\ ";$Q=$ADD(Q,AA1);PF(Q,31);$Q=" [OL ";$Q=$ADD(Q,AA2);PF(Q,31);P."."';P=1
2100XIFK=1 AND P=0;REP(7);$Q=" OLYL5";$Q=$ADD(AA2,Q);PF(Q,31);P.';X=1
2110ELSE IF P=0;REP(8);$Q="OLYL5";$Q=$ADD(AA2,Q);PF(Q,31);P.';X=1
2120XIF O?28=1 AND W=28;O?28=15;CC22=1
2130ELSE IFW=28;O?28=15;CC22=0
2140IFL=117 AND N=1 AND W<>9;O?W=0;$Q="VO KLHY [OL ";$Q=$ADD(Q,AA2);$R="ZHUR PU[V [OL Z^HTW5";$Q=$ADD(Q,R);PF(Q,31);P.'
2150PEND
2160PROC ET(W,N)
2170IFW=28 AND N=2 AND (CC22=1 OR L=15);REP(24);CC22=0;PEND
2180IF W=28;REP(21);PEND
2190IF O?W<>1;REP(8);$Q=" OLYL ";$Q=$ADD(AA2,Q);PF(Q,31);P.';PEND
2200IF N=1;IFW=9 OR W=29 OR W=50;REP(24);O?W=0;PEND
2210REP(6)
2220PEND
2230PROC CHA(W)
2240IFO?W<>1 AND O?W<>L AND W<>28;REP(7);$Q=" OLYL5";$Q=$ADD(AA2,Q);PF(Q,31);P.';PEND
2250IFW=28;REP(21);PEND
2260IFL=18;IFCC6=1;L=20;LOCAT(L);PEND
2270IFL=18;REP(25);PEND
2280IFL=20;IF CC6=1;L=18;LOCAT(L);PEND
2290IFL=20;REP(25);PEND
2300IFA.(L-42)=1;IFCC7=0;REP(25);PEND
2310IFA.(L-42)=1;IF O?26=1;L=L-2*SGN(L-42);LOCAT(L);PEND
2320IFA.(L-42)=1;REP(26);DEATH
2330IF A.(L*10-256)<1 AND O?34=26;REP(27);PEND
2340IFL=27 OR L=26;IFCC21=1 OR CC20=1;REP(26);DEATH
2350IFL=27 OR L=26;L=27+(L=27);LOCAT(L);PEND
2360IF L=15 AND W=55 AND O?48=1;L=142;REP(38);LOCAT(L);O?48=0;PEND
2370IF L=15 AND W=55;REP(37);PEND
2380REP(21)
2390PEND
2400PROC OT(W,N),P
2410$R="";K=0;P=0
2420IFN=1;IFCC8<>1;$Q=" HUK";$R=$ADD(R,Q)
2430IFW=5;$Q=" H ZL[ VM RL`Z3";$R=$ADD(R,Q);P=1
2440IFW=6;$Q="H ZL[ VM KYHNVUZ [LL[O";$R=$ADD(R,Q);P=1
2450IFW=26;$Q="H TP[OYPS ";$R=$ADD(R,Q);P=2
2460IFW=1 OR W=42 OR W=17 OR W=46;$Q="HU ";$R=$ADD(R,Q);P=2
2470IFW=50;$Q="H WPLJL VM Z[PS[VU3";$R=$ADD(R,Q);P=1
2480IFW=9;P=2
2490IFW=7;$Q="H O`KYH\SPJ ";$R=$ADD(R,Q);P=2
2500IFW=48 OR W=49;$Q="H ^VVKLU ";$R=$ADD(R,Q);P=2
2510IFW=11 OR W=20;$Q="H JS\Z[LY VM ";$R=$ADD(R,Q);P=2
2520IFW=16 OR W=18;$Q="H ZTHSS MVY[\UL PU ";$R=$ADD(R,Q);P=2
2530IFW=51;$Q="H IV_ VM ";$R=$ADD(R,Q);P=2
2540IFW=33;$Q="H NHUN VM ";$R=$ADD(R,Q);P=2
2550IFW=22;$Q="H ZTHSS QHY VM ";$R=$ADD(R,Q);P=2
2560IFW=21;$Q="H JVSSLJ[PVU VM SPIYHY` ";$R=$ADD(R,Q);P=2
2570IFW=19;$Q="H ZL[ VM ";$R=$ADD(R,Q);P=2
2580IFW=43;$Q="HU L]PS ";$R=$ADD(R,Q);P=2
2590IFW=36;$Q="H ILHYKLK ";$R=$ADD(R,Q);P=2
2600IFA.(W-14)<2;$Q="H IHY VM ";$R=$ADD(R,Q);P=2
2610IFW=44;$Q="H IHK ZTLSS3";$R=$ADD(R,Q);P=1
2620IFW=32 OR W=37 OR W=41;$Q="H TLHU SVVRPUN ";$R=$ADD(R,Q);P=2
2630IFW=30 OR W=42;$Q="H SHYNL ";$R=$ADD(R,Q);P=2
2640IFW=35 OR W=38;$Q="H MYPLUKS` ";$R=$ADD(R,Q);P=2
2650XIFW=27
2660XIFCC22=0;$Q=" H IV[[SL3";$R=$ADD(R,Q);P=1
2670ELSE $Q=" H IV[[SL VM ^H[LY3";$R=$ADD(R,Q);P=1
2680ELSE
2690XIFW=28 AND CC22=1 AND $LEFT(A,3)="PU]";P=1
2700ELSE IF W=28;P=2
2710IFP=0;$Q=" H ";$R=$ADD(R,Q)
2720IFP<>1;$AA3=$R;WITEM(W);$R=$ADD(AA3,R);$Q="3";$R=$ADD(R,Q);$Q=" ";IF INSTR($R," ")=0;$R=$ADD(Q,R);K=1
2730IFN<=2;$R=$LEFT(R,(L.R)-1)
2740IFL<>1;IFN=1;$Q=" OLYL";$R=$ADD(R,Q)
2750IFN=1;$Q="5";$R=$ADD(R,Q)
2760IF CC3+L.(R)>30;PF(R,31)
2770IFK=1;IF ?R=32;$R=$RIGHT(R,(L.R)-1)
2780CC2=0;PF(R,31)
2790PEND
2800PROC RD(W)
2810 IFW=28;REP(21);PEND
2820 IFO?W<>L;IFO?W<>1;REP(7);$Q=" OLYL";$Q=$ADD(AA2,Q);PF(Q,31);P.';PEND
2830 XIFW=21;$Q="[OL IVVRZ [LSS VM H SHUK HJYVZZ [OL ^H[LY";PF(Q,31);P.'
2840 ELSE REP(21)
2850PEND
2860PROC PW(W)
2870 IFW=28;REP(21);PEND
2880 I=11;IFO?W<>L;IFO?W<>1;REP(7);$Q=" OLYL5";$Q=$ADD(AA2,Q);PF(Q,31);P.';PEND
2890 IFW=34;DO I=I+1;U.I=26 OR O?I=1;XIFI<26;O?I=51;WITEM(I);GOS.460;O?34=0;C=C-1
2900 ELSE REP(28)
2910PEND
2920PROC LIGHT(W)
2930XIFO?W<>L;IFO?W<>1;IFW<>28;REP(7);$Q=" OLYL5";$Q=$ADD(AA2,Q);PF(Q,31);P.';PEND
2940ELSE IFW=28;REP(21);PEND
2950XIFW=51;O?51=0;REP(35)
2960IFL=142;REP(36);L=136;LOCAT(L);PEND
2970IFW=51;PEND
2980ELSE
2990IFW=3;IFH=0;IFN>0;H=1;P."YOUR LAMP IS NOW ON"';PEND
3000IFW=3;IFH=0;P."YOUR LAMP HAS RUN OUT"';PEND
3010IFW=3;P."YOUR LAMP IS ALREADY LIT!"';PEND
3020REP(21)
3030PEND
3040PROC WFL(W)
3050IFW=28;REP(21);PEND
3060XIF O?W<>L AND O?W<>1;REP(7);$Q=" OLYL5";$Q=$ADD(AA2,Q);PF(Q,31);P.';PEND
3070ELSE IF O?F<>1;REP(8);$Q="5";$Q=$ADD(AA2,Q);PF(Q,31);P.';PEND
3080IFW=27;IFL=O?28;IFCC22=0;P."YOUR BOTTLE IS NOW FULL OF WATER"';CC22=1;PEND
3090IFW=27;IFL=O?28;P."YOUR BOTTLE IS ALREADY FULL."';PEND
3100REP(21)
3110PEND
3120 
3130?#12=#29;RUN
3140 
3150     GERRIT  HILLEBRAND
3160     ACORNSOFT'S SPHINX
