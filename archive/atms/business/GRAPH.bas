
10 DIM P(240),T(64);FDIM %AA(52)
20 FOR A=0 TO 52;%AA(A)=0;NEXT
30 %AA(0)=1
300 A=FIN"";SGET A,T
310 SGET A,T
320 FOR N=0 TO 52
330 %AA(N)=FGET A
340 NEXT N;W=%AA(0)
350 GOSUB 1200
360 INPUT $P
370 PRINT $12
380 END
1200 REM START OF PLOT ROUTINE
1210 CLEAR 4
1220 MOVE 20,20
1230 PLOT 1,0,150;MOVE 20,20
1240 PLOT 1,208,0
1250 FOR A=30 TO 170 STEP 10
1260 MOVE 20,A;PLOT 1,2,0
1270 NEXT A
1280 FOR A=28 TO 228 STEP 8
1290 MOVE A,18;PLOT 1,0,4
1300 NEXT A
1310 %T=0;N=0
1320 FOR A=1 TO 52
1330 %T=%T+%AA(A)
1340 FIF %AA(A)=0 THEN N=N+1
1350 NEXT A
1360 N=52-N;%T=%T*52/N
1370 N=%T/15+9
1380 N=N/10;REM N=1 PIXEL WORTH
1390 MOVE 20,20;%T=0
1400 FOR A=1 TO 52
1410 %T=%T+%AA(A);X=%T/N+20
1420 Z=5;FIF %AA(A)=0 THEN Z=4
1430 PLOT Z,(A*4+20),X;NEXTA
1500 REM PLOT ACTUALS
1510 FOR A=1 TO 52
1520 X=%AA(A)/N+20
1530 Z=5;FIF %AA(A)=0THEN Z=4
1540 IF A=1 THEN Z=13
1550 PLOT Z,(A*4+20),X;NEXTA
1600 REM 3 WEEK AVERAGES
1610 FOR A=1 TO 50
1620 Z=5;%T=0;IF A=1 THEN Z=13
1630 FOR B=0 TO 2
1640 FIF%AA(A+B)=0 THEN Z=4
1650 %T=%T+%AA(A+B)
1660 NEXT B
1670 %T=%T/3
1680 X=%T/N+150
1690 PLOT Z,(A*4+28),X
1700 NEXTA
1710 $P="AVG"
1720 MOVE 40,140;GOSUB 3000
1730 $P="ACT"
1740 MOVE150,50;GOSUB 3000
1750 $P="CUMULATIVE" 
1760 MOVE 150,100;GOSUB 3000
1800 M=0;FOR B=40 TO 160 STEP 20
1810 M=M+(N*20)
1820 STR M,P
1830 GOSUB 5200
1840 MOVE 0,B;GOSUB 5000
1850 NEXT B
1860 M=W+3
1870 FOR B=31 TO 223 STEP 16
1880 STR M,P
1890 STR M,P;GOSUB 5200
1900 MOVE B,5;GOSUB 5000;M=M+4
1910 IF M>52 THEN M=M-52
1920 NEXT B
1930 $P=$T
1940 MOVE 40,180;GOSUB 3000
1950 R.
3000 IF LENP>40 THEN R.
3010 P!60=#2848281F;?(P+64)=#1F
3011 P!65=#4949497F;?(P+69)=#36
3012 P!70=#4141413E;?(P+74)=#22
3013 P!75=#41417F41;?(P+79)=#3E
3014 P!80=#4149497F;?(P+84)=#41
3015 P!85=#4048497F;?(P+89)=#40
3016 P!90=#4545413E;?(P+94)=#26
3017 P!95=#0808087F;?(P+99)=#7F
3018 P!100=#417F4100;?(P+104)=#00
3019 P!105=#41410102;?(P+109)=#7E
3020 P!110=#2214087F;?(P+114)=#41
3021 P!115=#0101017F;?(P+119)=#01
3022 P!120=#2010207F;?(P+124)=#7F
3023 P!125=#0408107F;?(P+129)=#7F
3024 P!130=#4141413E;?(P+134)=#3E
3025 P!135=#4848487F;?(P+139)=#30
3026 P!140=#4345413E;?(P+144)=#3F
3027 P!145=#4644443F;?(P+149)=#39
3028 P!150=#49494932;?(P+154)=#26
3029 P!155=#407F4040;?(P+159)=#40
3030 P!160=#0101017E;?(P+164)=#7E
3031 P!165=#0201027C;?(P+169)=#7C
3032 P!170=#0204027F;?(P+174)=#7F
3033 P!175=#14081463;?(P+179)=#63
3034 P!180=#08070870;?(P+184)=#70
3035 P!185=#51494543;?(P+189)=#61
3036 P!190=#4141413E;?(P+194)=#3E
3037 P!195=#017F2100;?(P+199)=#00
3038 P!200=#45434121;?(P+204)=#39
3039 P!205=#49494922;?(P+209)=#3E
3040 P!210=#041F047C;?(P+214)=#04
3041 P!215=#4949497A;?(P+219)=#4E
3042 P!220=#0949291E;?(P+224)=#06
3043 P!225=#504F4040;?(P+229)=#60
3044 P!230=#49494936;?(P+234)=#36
3045 P!235=#49494930;?(P+239)=#3E
3050 FOR A=0 TO LENP-1
3060 P!42=CH$P;$P=$P+1
3070 P!42=(P!42)-65;IF P!42>-18;IF P!42<0THEN P!42=(P!42)+43
3080 IF P!42<0 OR P!42>35 THEN PLOT 0,6,0;NEXT A ;R.
3090 P!42=P!42*5
3100 DO P!46=P?(60+(P!42))
3110 P!50=0;DO 
3120 PLOT(((P!46)&1)+8),0,1
3130 P!50=P!50+1;P!46=(P!46)/2
3140 UNTIL P!50=7
3150 PLOT 0,1,-7
3160 P!42=(P!42)+1
3170 UNTIL (P!42)%5=0
3180 PLOT 0,1,0
3190 NEXT A 
3200 R.
5000 IFLENP>10 THEN R.
5010 P!12=#6E3E4477;P!16=#467B6B4D
5020 P!20=#00004F7F
5030 P!36=LENP
5040 DO P!32=CH$P
5050 $P=$P+1;P!32=(P!32)-48
5060 IF (P!32)<0 OR (P!32)>9 THEN PLOT 0,5,0;G.5120
5065 P!32=P?((P!32)+12)
5070 FOR A=1 TO 7
5080 P!24=(2-A%6)%2;P!28=(2-(A-1)%4)%2
5090 PLOT ((P!32)&1),((P!28)*3),((P!24)*3)
5100 P!32=(P!32)/2
5110 NEXT A; PLOT 0,2,0
5120 P!36=(P!36)-1
5130 UNTIL P!36=0
5140 R.
5200 A=LENP-1;IF LENP>99THEN R.
5210 DO P!100=CH$P+A
5220 IF P!100=48 THEN $P+A="" 
5230 A=A-1;UNTIL A=0 OR P!100<>48 
5240 R.
