
10 FDIM %NN(84),%PP(13);DIM P(64)
20 FOR N=1 TO 84
30 %NN(N)=0 
40 IF N<13 THEN %NN(N)=1
50 IF N=14 THEN %NN(N)=12
60 NEXT
70 PRINT $12,"MENU OF OPTIONS"''
80 PRINT "1=ENTER FACTORS"'
90 PRINT "2=ENTER BUDGETS"'
100 INPUT"ENTER NUMBER "A
110  IF A<1 OR A>2 THEN G.100
120 G.(100+A*100)
200 INPUT "ARRAY NO"A;%T=0
210 IF A<1 OR A>5 THEN G.200
220 FOR N=1 TO 13
230 PRINT"MONTH",N;FINPUT%A
240 FIF%A<0 THEN G.230
250 %NN(A*14+N)=%A;%T=%T+%A
260 NEXT
270 %NN(N+A*14)=%T;G.70
300 INPUT "ARRAY NO - MAY BE 0"A
310 IF A<0 OR A>5 THEN G.300
320 PRINT $12;FINPUT "BUDGET AMOUNT "%B;%R=0.5;B=%B
330 PRINT "     MONTH    PERIOD   YTD"'
340hN=A*14;%T=%NN(N+14);T=0
350 FOR X=1 TO 13
360 %PP(X)=%B*%NN(N+X)/%T+%R;T=T+%PP(X)
370 NEXT
380 IF T<>B THEN GOSUB 1000
390 T=0
400 FOR X=1 TO 13
410 T=T+%PP(X)
420 PRINT X,%PP(X),T'
430 NEXT
500 INPUT"MORE"$P
510 IF $P="Y" THEN G.300
520 G.70
1000 REM ADJUST FOR ROUNDING
1010 D=T-B;U=D/ABSD
1020 X=1
1030 %PP(X)=%PP(X)-U
1040 D=D-U;IF D=0 THEN R.
1050 X=X+1;IF X=13 THEN X=1
1060 G.1030
2000 END
