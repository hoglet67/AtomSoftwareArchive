
10REM**ACCOUNT**
30X=31*4;Y=25*4
40F=#8200;G=F+Y;H=G+Y;I=H+Y;J=I+X;Q=J+X;C=Q+Y
50F.N=0TO Y+4 S.4;C=C+11;Q!N=C;$Q!N="";N.
60F.N=0TO Y S.4;F!N=0;G!N=0;H!N=0;N.
70F.N=0TO X S.4;I!N=0;J!N=0;N.
80D=C+11;E=D+9;V=U+26;W=V+9;B=W+21;L=B+11
90$D="";$E="";$U="";$V="";$W=""
100$B="           ";$L="-----------------"
110DIMO41,Z5
120$O="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789,./:n"
130$Z="cder^" 
150DIM LL8,RR5;F.N=0TO 8;LLN=-1;N.;F.N=0TO 5;RRN=-1;N.
155P.$21;F.N=1TO 2;DIM P-1
160[:LL0 LDA@#40;LDY@0  
170:LL1 STA(#96),Y;INY
180CPY#9A;BNE LL1;RTS
190:RR0 LDY@0
195:RR1 JSR#FFE3;CMP@CH"@";BNE RR2
200JSR LL0;LDA#80;STA#E0
205LDA@7;JSR#FFF4;JMP RR0
210:RR2 LDX@254
215:RR3 INX;CPX@L.O;BEQ RR4 
220CMP O,X;BNE RR3
225STA U,Y;JSR#FFF4
230INY;JMP RR1
235:RR4 LDX@254
240:RR5 INX;CPX@L.Z;BEQ RR1
245CMP Z,X;BNE RR5
250STA U,Y;LDA@13;INY
260STA U,Y;RTS
310:LL2 LDY@32;LDX@0
320:LL3 LDA(#90),Y;STA(#90,X)
330 CLC
340LDA#90;ADC@1;STA#90
350LDA#91;ADC@0;STA#91
360LDA#90;CMP#92;BNE LL2
370LDA#91;CMP#93;BNE LL2
380JSR LL0;RTS
381:LL4 LDA@#80;STA#90;STA#91
382LDA@#5F;STA#92;LDA@#81;STA#93
383LDX@0;LDY@32
384:LL5 LDA(#92,X);STA(#92),Y 
385LDA#92;CMP#90;BNE LL6
386LDA#93;CMP#91;BNE LL6;JSR LL0;RTS
387:LL6 SEC
388LDA#92;SBC@1;STA#92;BCS LL5
389LDA#93;SBC@0;STA#93;JMP LL5
390:LL7 JSR#FFE3;CMP@CH"r";BEQ LL8;CMP@CH"e";BNE LL7 
391:LL8 STA U;RTS;]
392N.;P.$6
393P.$12;?#E1=0;P.$B"bank"$255"account"$255 '$B$L+4
395R=64
400GOS.f;?#E1=0
410GOS.a
420DO !#DE=#81A0;?#9A=26;!#96=#81A6;?#80=6
430P."entry?";LI.LL0;LI.RR0
435IF$U="~";IF R;GOS.l;U.0
436IF R=0 OR R=32;R=96;GOS.l
440IF$U="e"G.h
450IF$U="r"GOS.g;GOS.a;U.0
460K=L.U;Y=U?(K-1);IFY<>CH"c"IFY<>CH"d"P.$7;U.0
470GOS.b
480U.0
490h$E=$D;GOS.e
500END
510aP.$12;?#E1=0;?#E0=9;?#8000=#40;P."statement"$255"date"$D" "
520P.''"DATE     CREDITS DEBITS BALNCE"$L$L
530@=7
540F.X=68TO 96 S.4
550P.$Q!X;?#E0=11;P.F!X,G!X,H!X
560N.
570P.$L$L
580GOS.w
590R.
600bC=-1;A=C;$W=""
610rDO C=C+1;U.U?C=CH","OR C=K
620DO A=A+1;U.(U?A>CH"9"AND U?A<CH"[")OR A=K
630IFC=0;$U=$U+1;K=K-1;GOS.r;R.
640IF C<K $V=$U+C+1;$U+C="";IF A<C;IF A;$W=$U+A;$U+A=""
650IF C<K;IF A=0;$W=$U;$U=$D
660IF C<K$D=$U;M=4*V.D;N=4*V.E;IF A=0;IF A<>C;N=N-4
670IF C<K;IF A;GOS.d
680IF C=K$V=$U;$U=$D
690 !#DE=#8017;P.$D$B+3
700 $Q!100=$U;$Q!100+LEN(Q!100)=$W;$Q!100+11=""
710Y=V?(L.V-1);%V=100*V.V
720IF Y=CH"c"G!100=0;F!100=%V;H!100=H!96+F!100
730IF Y=CH"d"F!100=0;G!100=%V;H!100=H!96-G!100
740F.X=4TO 96S.4;T=X+4;$Q!X=$Q!T;F!X=F!T;G!X=G!T;H!X=H!T;N.
760!#90=#8080;!#92=#8160;!#96=!#92;?#9A=11;?#80=6
770WAIT;LI.LL2
780 !#DE=#8160;P.$Q!96;?#E0=11;P.F!96;G!96;H!96
790R.
800cP.$12;?#E1=0;P.$B+2"standing"$255"orders"
810P.$L$L
820 DO
830P.'"DATA,AMOUNT<d/c>?";!#80=!#DE;GOS.u;!#DE=!#80
840 !#96=!#DE+17;?#9A=15;?#80=17;LI.RR0;IF$U="e";G.j
850 C=0;DO C=C+1;U.U?C=CH","OR C=L.U
860IF C=L.U;U.0
870 $V=$U+C+1;$U+C=""
880N=4*V.U;Y=L.V-1
890IF V?Y=CH"d"I!N=I!N*(V?(Y-1)<>CH"n")+%(100*V.V)
900IF V?Y=CH"c"J!N=J!N*(V?(Y-1)<>CH"n")+%(100*V.V)
910jU.$U="e"
920gP.$12;?#E1=0;P.#B+2"STANDING ORDERS"''$B+4"DATE:TRANSFERS:"
930P." S.ORDERS"'
940P.$L$L
950@=10;F.N=4TO124S.4;IF I!N OR J!N;P.'N/4,J!N,I!N
960N.;P.'$L$L
970GOS.x
980LI.LL7
990IF?U=CH"r"G.c
1000GOS.x
1010 R.
1020dDO
1030 DO N=N+4;IF N/4>31 N=4
1040 U.I!N OR J!N OR (N=M);IF I!N=0 AND J!N=0 G.k
1050F.X=4TO92S.4;T=X+4;$Q!X=$Q!T;F!X=F!T;G!X=G!T;H!X=H!T;N.
1070G!96=I!N;F!96=J!N;H!96=H!92-I!N+J!N
1080 STR N/4,Q!96;$Q!96+2="";IF N<10;$Q!96+1=""
1090IF J!N;$Q!96+L.(Q!96)=" TFR"
1100IF I!N;$Q!96+L.(Q!96)=" S.O"
1110!#90=#8080;!#92=#8160;!#96=!#92;?#9A=11
1120WAIT;LI.LL2
1130!#DE=!#92;P.$Q!96;?#E0=11;P.F!96,G!96,H!96
1140kU.N=M;$E=$D
1150R.
1160eGOS.z;!#DE=#800081A0
1170 S=FO.""
1180 SP.S,D;F.N=4TO124S.4;PUT S,I!N;PUT S,J!N;N.
1190F.N=4TO96S.4;SP.S,Q!N;PUT S,F!N;PUT S,G!N;PUT S,H!N;N.
1200P.$11"starement"$255"page"$255"saved";R.
1210f!#DE=#800080AB;?#8036=#40
1230 S=F.""
1240S.S,E;F.N=4TO 124 S.4;I!N=G.S;J!N=G.S;N.
1250F.N=4TO 96 S.4;S.S,Q!N;F!N=G.S;G!N=G.S;H!N=G.S;N.
1260IF V.E=0 DO $E=$(E+1);U.V.E
1270$D=$E
1280R.
1290u!#DE=#81E0;P."ReVIEW S.O'S"$B$B+2;R.
1300w!#DE=#81E0;P."rEVIEW S.O'S  eND SESSION";R.
1310x!#DE=#81E0;P."rEVISE S.O'S  eND S.O'S";R.
1320z!#96=#81A0;!#9A=96;WAIT;LI.LL0;R.
1400@=7;!#9A=11;!#96=#8080
1410F.N=R TO R-28 S.-4
1420!#DE=#8080;LI.LL4
1430P.$Q!N;?#E0=11;P.F!N,G!N,H!N
1440N.
1450R=N;R.
