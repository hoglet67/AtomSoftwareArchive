
0REM ********************
1REM *****BACKGAMMON*****
2REM ***BY P.ROBINSON****
3REM ******MCMLXXXI******
4REM ********************
5REM
9P=#81;P.$21;[JSR#FFE3;STA#80;RTS;];P.$6
10CLEAR4;O=#8000
20F.A=10TO182S.2;MOVE10,A;DRAW222,A;N.
25F.A=11TO221S.2;MOVEA,10;PLOT6,A,182;N.
30F.A=1TO12;Z=0;F.B=-16TO0;IFA>6;Z=16
40MOVE(A*16+3+Z),112;PLOT(7-(1-(A%2))*2),(A*16+11+B+Z),182
50MOVE(A*16+3+Z),80;PLOT(7-(A%2)*2),(A*16+11+B+Z),10;N.;N.
60MOVE9,10;DRAW9,182;DRAW220,182;DRAW220,10;DRAW9,10
70MOVE8,9;DRAW8,183;DRAW221,183;DRAW221,9;DRAW8,9
80MOVE7,8;DRAW7,184;DRAW222,184;DRAW222,8;DRAW7,8
90F.A=1TO11;MOVE(109+A),10;DRAW(109+A),182;N.
100DIMPP26;F.A=0TO26;PPA=0;N.;PP1=20;PP6=5;PP8=3;PP12=50;PP13=5
110PP17=30;PP19=50;PP24=2
115DIMWW4,BB4;V=#2800
120!V=#FFFF7E3C;V!4=#3C7EFFFF;V!8=#8181423C;V!12=#3C428181
122V!16=#10284444;V!20=#00101010;V!24=#44444438;V!28=#00384444
124V!32=#44444444;V!36=V!28;V!40=#78444478;V!44=#00444444
126V!48=#44546C44;V!52=V!44;V!56=V!24;V!60=V!28;V!64=V!32
127V!68=#00102828;V!72=#7840407C;V!76=#007C4040
150F.B=1TO24;IFPPB<>0 GOS.c;GOS.d
170N.
200GOS.w;X=#8B1C;F.A=0TO3;F.B=0TO7;?(X+A+B*32)=0
220X?(A+B*32)=(X?(A+B*32)):(V?(B+16+A*8));N.;N.;X=#8C5C
230F.A=0TO3;F.B=0TO7;?(X+A+B*32)=0
240X?(A+B*32)=(X?(A+B*32)):(V?(B+48+A*8));N.;N.
245B=1
250IFB=25;B=1
254X=(12-B)*16+18;Y=10;IFB<7X=X+16
255IFB>12 X=(B-13)*16+18;Y=184;IFB>18X=X+16
260L=O+(192-Y)*32+X/8;?L=0;F=L
270LINK#81;E=?#80
276IFPP25<>0B=25;G.290
280IFE=91B=B+1;B=B%25;?L=255;IFB=0B=1
285IFE=93B=B-1;B=B%25;?L=255;IFB=0B=24
290D=0;N=0;F.A=7TO24;IFPPA<9 N=N+PPA
296N.;IF N=0 D=1
300E=E-48;IFE<>WW1 IFE<>WW2 IFE<>WW3 IFE<>WW4 IFE<>0 G.250
310IFE=0;?F=255;G.400
320IFPPB>9ORPPB=0 P.$7;G.250
325IF(B-E)>0 ORD=0;G.330
326GOS.c;GOS.m;PPB=PPB-1
327N=0;F.A=1TO6;IFPPA<9 N=N+PPA
328N.;IFN=0 A=0;G.6000
329G.365
330IF(B-E)<1 P.$7;G.250
335IFPP(B-E)=5 P.$7;G.250
340IFPP(B-E)>19 P.$7;G.250
342IFPP(B-E)<>10;G.360
343B=B-E
344GOS.c;GOS.m;PPB=0;PP0=PP0+10;X=115;Y=108+(PP0/10)*9;B=B+E
346C=Q;S=0;GOS.m
360IFB<>25 GOS.c;GOS.m
361IFB=25 X=115;Y=92-PP25*9;C=Q
362PPB=PPB-1;B=B-E;PPB=PPB+1;GOS.c;GOS.m;B=B+E
365IFE=WW1 WW1=0;G.390
370IFE=WW2 WW2=0;G.390
375IFE=WW3 WW3=0;G.390
380IFE=WW4 WW4=0
390IFWW1<>0 ORWW2<>0 ORWW3<>0 ORWW4<>0;G.250
399IFB<>25;?F=255
400X=#8B1C;F.A=0TO3;F.B=0TO7;?(X+A+B*32)=0
410?(#8B1D+B*32)=V?(B+48);?(#8B1E+B*32)=V?(B+16);N.;N.;GOS.b
420IFPP0=0;G.495
425M=0;F=0;D=0
430F.A=1TO4;S=1;E=BBA;IFE=0G.475
440P=PPE;IFP=10 S=S+3
445IFP=50 S=0;G.475
450IFP<10A.P>1G.475
460IFP=1 S=S+2
470B=0;IFS>M F=A;M=S
475N.;E=BBF;BBF=0;IFF=0;G.200
476G.542
495D=0;N=0;F.A=1TO18;N=N+PPA/10
496N.;IFN=0 D=1
500M=0;I=0;DO I=I+1;P=PPI;IFP<10G.524
501F.A=1TO4;S=0;E=BBA;IFE=0;G.520
503IFI+E=25A.D=1 S=200;G.516
504IFI+E>24A.D=0G.520
505IFI+E>24A.D=1 S=20;IFI>25-E;S=1;G.516
506P=PP(I+E);Q=PPI;IFD=1G.516
508IFP=50 S=0;G.520
509IFP<10A.P>1G.520
511S=(24-I)/6;IFQ=20A.I>17S=1
512IFP=1 S=S+2
513IFP=10 S=S+2+I/4
514IFQ=10A.P=10;S=S+3+I/3
515IFQ>20A.P=10;S=S+5+I/3
516IFS=M S=S+R.%2;G.516
518IFS>M B=I;F=A;M=S
520N.
524U.I=24;E=BBF;BBF=0;IFM=0G.200
525IF(B+E)<25 ORD=0;G.542
526GOS.c;GOS.m;PPB=PPB-10
527N=0;F.A=19TO24;N=N+(PPA)/10;N.
528IFN=0 A=1;G.6000
530G.595
542IFPP(B+E)<>1;G.560
543B=B+E
544GOS.c;GOS.m;PPB=0;PP25=PP25+1;X=115;Y=92-PP25*9;B=B-E
546C=-Q;S=0;GOS.m
560IFB<>0 GOS.c;GOS.m
561IFB=0 X=115;Y=108+(PP0/10)*9;C=Q;S=0;P=PP0/10;GOS.m
562PPB=PPB-10;B=B+E;PPB=PPB+10;GOS.c;GOS.m;B=B-E
595IFBB1+BB2+BB3+BB4<>0G.420
600G.200
4998E.
5000cP=PPB;Q=0
5010IFP<10 Q=1
5015IFP>9P=P/10
5020X=(12-B)*16+18;Y=20;S=-#120;IFB<7X=X+16
5030IFB>12 X=(B-13)*16+18;Y=181;S=#120;IFB>18X=X+16
5035C=B%2;R.
5040dL=(192-Y)*32+X/8+O;Z=8;IFC=Q Z=0
5050F.A=1TO P;F.K=0TO7
5060;?(L+K*32)=(?(L+K*32)):(V?(K+Z));N.;L=L+S;N.;R.
5100mIFP=0 R.
5110L=(192-Y)*32+X/8+O;L=L+(P-1)*S;Z=8;IFC=Q Z=0
5120F.K=0TO7;?(L+K*32)=(?(L+K*32)):(V?(K+Z));N.;R.
5200wF.A=34TO54;MOVEA,86;DRAWA,106;MOVE(A+30),86;DRAW(A+30),106
5210N.;WW1=A.R.%6+1;WW2=A.R.%6+1;WW3=0;WW4=0;IFWW2<>WW1G.5220
5215WW3=WW1;WW4=WW1
5220Z=0;GOS.((WW1*20)+5230);Z=30;GOS.((WW2*20)+5230);R.
5225bF.A=145TO167;MOVEA,86;PLOT7,A,106;MOVE(A+30),86
5230PLOT7,(A+30),106;N.;BB1=A.R.%6+1;BB2=A.R.%6+1;BB3=0;BB4=0
5231IFBB1=BB2;BB3=BB2;BB4=BB2
5240Z=112;GOS.((BB1*20)+5230);Z=142;GOS.((BB2*20)+5230);R.
5250X=44;Y=96;GOS.s;R.
5270X=39;Y=101;GOS.s;X=49;Y=91;GOS.s;R.
5290X=39;Y=101;GOS.s;X=49;Y=91;GOS.s;X=44;Y=96;GOS.s;R.
5310X=39;Y=101;GOS.s;Y=91;GOS.s;X=49;GOS.s;Y=101;GOS.s;R.
5330X=39;Y=101;GOS.s;Y=91;GOS.s;X=49;GOS.s;Y=101;GOS.s;X=44
5340Y=96;GOS.s;R.
5350F.X=39TO49S.10;F.Y=91TO101S.5;GOS.s;N.;N.;R.
5400sF.A=-2TO2;K=2-A.A;MOVE(X+K+Z),(Y+A);PLOT6,(X+Z-K),(Y+A)
5410N.;R.
6000P.$12;IFA=0G.6100
6010P."        I WIN!"''"COMPUTERS REIGN SUPREME!!"'''
6020G.6200
6100P."CONGRATULATIONS ON A SKILFUL WIN"''''''
6200P."DO YOU WANT ANOTHER GAME?";LINK#81;IF?#80=89 RUN
6210E.
