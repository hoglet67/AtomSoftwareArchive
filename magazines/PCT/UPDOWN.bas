
50 REM**WRITTEN FOR THE ACORN ATOM
55 REM**THIS PROGRAM ALLOWS YOU TO STOP A LISTING AT ANY TIME
60 REM**WITH THE CTRL KEY. YOU CAN THEN LIST BACKWARDS TOWARDS
65 REM**LINE 0 BY PRESSING THE KEY 'S'. CONTINUE NORMAL LISTING
70 REM**BY PRESSING THE SHIFT KEY
75 REM**THE ESC-KEY WORKS AT ALL TIMES
80 REM**AFTER HITTING BREAK BRING PROGRAM BACK INTO OPERATION
85 REM**WITH LINK#2902. THIS ALSO RELOCATES THE TEXT SPACE
90 REM**TO #2B00
95 REM*****************************************************	
100 DIM LL50
110 S=#80;T=#82
120 FOR I=0 TO 50;LLI=-1;NEXT
130 PRINT $21
140 GOSUB z
145 PRINT $6
150 GOSUB z
160 PRINT $6
180 END
200zP=#2902;[
210:LL0 LDA@#2B
220 STA #12
230 LDA@LL1&#FF
240 STA#0208
250 LDA@LL1&#FFFF/256
260 STA#0209  
270 RTS
290 \
300 \*MAIN PROGRAM STARTS HERE*
310 \
320:LL1 PHP
330 CMP@#D	
340 BEQ LL2
350 PLP
360 JMP#FE52  
370:LL2 JSR #FE52
380 BIT#B001 
390 BVC LL4 
400:LL3 LDA@#D
402 PLP
410 RTS
420:LL4 TXA
430 PHA
440 STY#80
450:LL5 JSR#FE71
460 CPY@#3B
470 BNE LL6
480 JMP#C2CF
490:LL6 CPY@#FF
500 BEQ LL7  
510 CPY@#33  
520 BNE LL5  
530 BEQ LL8
540:LL7 BIT#B001	
550 BMI LL5
560 LDY#80
570 PLA
580 TAX
590 CLC
600 BCC LL3
610 \ 
620 \**HERE ON BACKSTEP**
630 \
640:LL8 JSR LL20  
650 CPX@62
660 BCC LL9
670 JSR LL30
680:LL9 CPX@30
690 BCC LL10
700 JSR LL30 
710:LL10 JSR LL30  
720 JSR LL30
730 LDA T
740 STA #58
750 LDA T+1
760 STA#59
770 JSR LL40  
780 JSR#CD54  
790 CLC
800 BCC LL5
1000 \
1010 \**SEARCH FOR THE LINE PRECEEDING THE ONE PRINTED LAST**
1020 \S IS SEARCH POINTER. T IS TEMPORARY STORAGE
1030 \
1040:LL20 LDA #12 
1050 STA S+1
1060 LDA @0
1070 STA S
1080 CMP#58
1090 LDA S+1
1100 SBC#59
1110 BCC LL22	
1120:LL21 JSR#FE71
1130 CPY@#FF
1140 BNE LL21
1150 PLA
1160 PLA
1170 LDA T+3
1180 STA#80
1190 BNE LL7
1200:LL22 LDA S
1210 STA T
1220 LDA S+1 
1230 STA T+1
1240 LDY@2
1250 LDA@#D
1260:LL23 INY
1270 CMP(S),Y  
1280 BNE LL23  
1290 STY T+3  
1300 LDA S
1310 CLC
1320 ADC T+3
1330 STA S
1340 BCC LL24
1350 INC S+1
1360:LL24 CMP#58
1370 LDA S+1	
1380 SBC#59 
1390 BCC LL22
1400 LDY@2 
1410 LDA@#D
1420:LL25 INY	
1430 CMP(S),Y
1440 BNE LL25
1450 TYA
1460 TAX
1470 CPX@62	
1480 BCC LL26	
1490 JSR LL30
1500:LL26 CPX@30
1510 BCC LL27
1520 JSR LL30
1530:LL27 LDX T+3
1540 RTS
1600 \
1610 \**MOVE CURSOR UP**	
1620 \
1630:LL30 LDY@0
1640 LDA (#DE),Y	
1650 EOR#E1
1660 STA (#DE),Y  
1670 LDA#DE
1680 SEC
1690 SBC @#20
1700 STA#DE 
1710 BCS LL32
1720 LDA #DF	
1730 CMP@#81	
1740 BCS LL31
1750 JSR LL35	
1760 INY
1770 BEQ LL32
1780:LL31 DEC#DF
1790:LL32 LDA(#DE),Y
1800 EOR#E1
1810 STA(#DE),Y
1820 RTS
1830 \
1840 \**SCROLL SCREEN DOWNWARDS BY 1 LINE**
1850 \
1860:LL35 JSR#FE66
1870 LDY@#FF
1880:LL36 LDA#8100,Y  
1890 STA #8120,Y
1900 DEY
1910 CPY@#FF
1920 BNE LL36
1930 JSR#FE66	
1940:LL37 LDA#8000,Y
1950 STA#8020,Y
1960 DEY
1970 CPY@#FF
1980 BNE LL37
1990 LDA@#80	
2000 STA#DF
2010 INY
2020 STY#DE
2030 STY#E0
2040 JSR#FE22	
2050 RTS
2060 \
2070 \**PRINT LINE**
2080 \
2090:LL40 LDY@1
2100 LDA(#58),Y
2110 STA#25	
2120 INY
2130 LDA (#58),Y
2140 STA#16
2150 LDA@5
2160 STA#321	
2170 JSR#C589	
2180 LDA@8
2190 STA #0321
2200 LDY@3
2210:LL41 LDA(#58),Y  
2220 CMP@#D
2230 BEQ LL42	
2240 JSR #CA4C
2250 INY
2260 BNE LL41
2270:LL42 STY#80
2280 RTS
2290];RET.
