
1DIMMM(10),VV(10),DD(10),T(11),RR(2),P(-1)
2P.$21
3[
4:RR1STX#80;RTS
5:RR0JSR#FFE3
6LDX@10
7:RR2CMPT,X;BEQRR1
8DEX;BPLRR2;BMIRR0
9RTS
10]
11P.$6
12$T=" ZXCASDQWE"
15S=#8000
16N=1
17GOS.i
18sIN.'"HOW MANY TREES (1-200)",O;IFO>200;O=200
19P.$12;?#E1=0
20F.J=1TOO
30X=A.R.%480+32
35IFS?X=255;G.30
40S?X=255
50N.
60S!60=#40404040
70S!92=#40884040
80S!124=#40404040
90S!416=#40404040
100S!448=#40404040
110S!480=#4040400F
111X=480
120F.I=1TO10;VV(I)=0;DD(I)=0;MM(I)=0;N.
121@=0
140F.I=1TON
142R=A.R.%447+32
144IFS?R=255G.142
146VV(I)=R;N.
147IFN=1;P."THERE IS 1 RHINO";G.149
148P."THERE ARE ",N," RHINOS"
149P.$30;F.J=0TO5000;N.
150P."your",$128,"go            ",$30
152LI.RR0
154P."       ",$30
155W=?#80
160GOS.(2000+W*1000)
250S?X=15
252IFX=94;G.15000
300Q=0
305F.I=1TON
310IFDD(I)=1;G.325
315R=VV(I)
317U=R%32;V=R/32;E=X%32;G=X/32
320IFU<>E;IFV<>G;IFA.(U-E)<>A.(V-G);G.325
321K=32*SGN(G-V)+SGN(E-U)
322F.J=R TO X S.K
323IFS?J=255;J=X;N.J;G.325
324N.J;DD(I)=1;Q=1;S?R=18
325N.I
330IFQ>0;G.150
350F.I=1TON
355IFDD(I)=0;G.570
360R=VV(I)
365MM(1)=S?(R+31)
370MM(2)=S?(R+32)
375MM(3)=S?(R+33)
380MM(4)=S?(R-1)
385MM(6)=S?(R+1)
390MM(7)=S?(R-33)
395MM(8)=S?(R-32)
400MM(9)=S?(R-31)
405IFMM(4)=255;IFMM(8)=255;MM(7)=255
410IFMM(8)=255;IFMM(6)=255;MM(9)=255
415IFMM(6)=255;IFMM(2)=255;MM(3)=255
420IFMM(2)=255;IFMM(4)=255;MM(1)=255
425K=R;Y=R
430U=R%32;V=R/32;E=X%32;G=X/32
435A=A.(U-E);B=A.(V-G);Z=A*A+B*B
439L=0
440F.J=32TO-32S.-32
450F.M=-1TO1
455L=L+1
460IFMML=255ORMML=136ORMML=18;G.n
470D=R+J+M;IFA.(D%32-R%32)=31ORD<32ORD>511;G.n
480IFMML=15;M=1;J=-32;I=N;N.;N.;N.;G.w
490GOS.r
500nN.;N.
560S?K=32;S?Y=18;R=Y
565VV(I)=R
570N.I
600G.150
1000rU=D%32;V=D/32
1030A=A.(U-E);B=A.(V-G);C=A*A+B*B
1040IFC<Z;Z=C;Y=D
1050R.
1500wS!(X-2)=#0D010817
1510F.J=0TO5000;N.
1520P.$12
1530P."PRESS A KEY TO GO AGAIN";LI.#FFE3 
1550G.s
2000P.$12"YOU RESIGN!"'
2010P."PRESS ANY KEY TO GO AGAIN";LI.#FFE3;G.s
3000IFS?(X+31)=255;R.
3010IFX%32=0ORX/32>=15;R.
3020S?X=32;X=X+31
3030R.
4000IFS?(X+32)=255;R.
4010IFX/32>=15;R.
4020S?X=32;X=X+32
4030R.
5000IFS?(X+33)=255;R.
5010IFX%32=31ORX/32>=15;R.
5020S?X=32;X=X+33
5030R.
6000IFS?(X-1)=255;R.
6010IFX%32=0;R.
6020S?X=32;X=X+1
6030R.
7000R.
8000IFS?(X+1)=255;R.
8010IFX%32=31;R.
8020S?X=32;X=X+1
8030R.
9000IFS?(X-33)=255;R.
9010IFX%32=0ORX/32=1;R.
9020S?X=32;X=X-33
9030R.
10000IFS?(X-32)=255;R.
10010IFX/32=1;R.
10020S?X=32;X=X-32
10030R.
11000IFS?(X-31)=255;R.
11010IFX%32=31ORX/32=1;R.
11020S?X=32;X=X-31
11030R.
15000P.$12,"PHEW,MADE IT!"'
15010P."PRESS A KEY TO GO AGAIN!";LI.#FFE3
15030N=N+1;IFN>10;N=10
15040G.s
16000iP.$12"YOU(O) ARE STRANDED IN RHINO"'
16020P."COUNTRY. YOUR ONLY HOPE IS TO"'
16030P."REACH THE SANCTUARY OF A HUT(h)"'
16040P."SITUATED IN A CLEARING ON THE"'
16050P."FAR SIDE OF THE TREES("$223")."'
16060P."ONCE YOU ARE IN A DIRECT LINE"'
16070P."WITH A HIDDEN RHINO (EITHER"'
16080P."HORIZONTAL,VERTICAL OR DIAGONAL)"
16090P."AND PROVIDING THERE ARE NO"'
16100P."INTERVENING TREES,IT WILL APPEAR"
16110P."AND PROCEED TO CHASE YOU."'
16120P."FORTUNATELY,THE RHINOS CAN MOVE"'
16130P."NO FASTER THEN YOU AND,BEING"'
16140P."BULKY,ARE UNABLE TO FOLLOW YOU"'
16150P."DIAGONALLY BETWEEN TREES."'
16160P."         press"$128"a"$128"key";LI.#FFE3
16170P.$12"TO MAKE YOUR MOVE,USE THE KEYS"' 
16180P."AROUND THE 'S'.YOU CAN RESIGN"'
16190P."FROM A CHASE AT ANY TIME BY"'
16200P."PRESSING THE SPACEBAR.NO OTHER"'
16210P."KEYS ARE RECOGNISED."'
16220P." SHOULD YOU SUCCEED IN REACHING"'
16230P."SAFETY, THE NUMBER OF RHINOS"'
16240P."WILL BE INCREASED BY ONE,UP TO A"
16250P."MAXIMUM OF TEN.YOU MAY CHOOSE"'
16260P."THE NUMBER OF TREES YOU WANT."'
16270P."THE MORE YOU HAVE,THE EASIER THE"
16280P."GAME."'
16290R.
