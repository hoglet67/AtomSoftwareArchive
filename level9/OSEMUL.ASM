.LFFE3
.OSWRCH
	PHA
IF  UpperCaseOnly
	CMP	#$60
	BCC	OSWRCH1
	AND	#$DF
.OSWRCH1
ENDIF
	JSR	$FFE9
	PLA
	CLC
	RTS

.LFFE0
.OSRDCH
	JSR $FFE3
	CMP #$1B
	BEQ ESCAPE
	CLC
	RTS
.ESCAPE
	SEC
	RTS
	
.LFFF1
.READLINE
	LDA #$00
	JSR $CD0F
	TYA
	PHA
.READLINE1
	LDA $100,Y
	STA $0,Y
	DEY
	BPL READLINE1
	PLA
	TAY
	CLC
	RTS
	
.LFFF4
.OSBYTE
	CMP #$91
	BNE OSBYTERTS
	JSR OSRDCH
	TAY
	CLC
.OSBYTERTS
	RTS
	
.LFFF7
.OSCLI
	RTS
	
.LFFDD
.OSFILE
	PHA
	LDX     #$00
	LDY     #$00
.OSFILE1
	LDA     (L0037),Y
	STA     $140,X
	INX
	INY
	CMP	#$0D
	BNE     OSFILE1	
	LDA     #$40
	STA     L0037
	LDA     #$01
	STA     L0038
	LDA     #$00
	STA     L0039
	LDA     #$04
	STA     L003A
	LDA     #$FF
	STA     L003B
	STA     L003B + 1
	LDA     #$00
	STA     L003B + 2
	LDA     #$04
	STA     L003B + 3
	LDA     #$00
	STA     L003B + 4
	LDA     #$0B
	STA     L003B + 5
	LDX     #$37
	LDY     #$00
	PLA
	BEQ     OSFILE2
	SEC
	JSR	$FFE0
	LDA 	#$01
	RTS
.OSFILE2
	SEC
	JSR     $FFDD
	LDA 	#$01
	RTS
